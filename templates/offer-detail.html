{{define "content"}}
<article>
    <header>
        <nav>
            <ul>
                <li><a href="/offers" class="secondary">&larr; Back to Offers</a></li>
            </ul>
            <ul>
                <li>
                    <button class="outline"
                            hx-get="/api/offers/{{.ID}}/preview"
                            hx-target="#pdf-preview">
                        Preview PDF
                    </button>
                </li>
                {{if eq .Status "draft"}}
                <li>
                    <button hx-put="/api/offers/{{.ID}}/send"
                            hx-confirm="Send this offer to the client?">
                        Send to Client
                    </button>
                </li>
                {{end}}
            </ul>
        </nav>
        <h2>Offer Details</h2>
    </header>

    <div class="grid">
        <!-- Offer Information -->
        <div>
            <article>
                <header>
                    <h3>Project Information</h3>
                </header>
                <p>
                    <strong>Client:</strong> {{.Client.Name}}<br>
                    <strong>Time Frame:</strong> {{.TimeFrame}} weeks<br>
                    <strong>Risk Factor:</strong> {{.RiskFactor}}<br>
                    <strong>Status:</strong> 
                    <span class="status-badge status-{{.Status}}">{{.Status}}</span>
                </p>
                {{if .Discount}}
                <p>
                    <strong>Discount:</strong> â‚¬{{.Discount.Amount}}<br>
                    <strong>Reason:</strong> {{.Discount.Explanation}}
                </p>
                {{end}}
            </article>

            <article>
                <header>
                    <h3>Team Members</h3>
                </header>
                <table>
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Role</th>
                        </tr>
                    </thead>
                    <tbody>
                        {{range .Employees}}
                        <tr>
                            <td>{{.Name}}</td>
                            <td>{{.Role}}</td>
                        </tr>
                        {{end}}
                    </tbody>
                </table>
            </article>
        </div>

        <!-- Requirements and Preview -->
        <div>
            <article>
                <header>
                    <h3>Project Requirements</h3>
                </header>
                <div class="requirements-content">
                    {{.RequirementsHTML}}
                </div>
            </article>

            <article id="pdf-preview">
                <!-- PDF preview will be loaded here -->
            </article>
        </div>
    </div>

    {{if eq .Status "sent"}}
    <article>
        <header>
            <h3>Offer Status</h3>
        </header>
        {{if .SkribbleLink}}
        <p>
            <strong>Signing Link:</strong> 
            <a href="{{.SkribbleLink}}" target="_blank">View on Skribble</a>
        </p>
        {{end}}
        <div class="grid">
            <button class="success outline"
                    hx-put="/api/offers/{{.ID}}/accept"
                    hx-confirm="Mark this offer as accepted?">
                Accept Offer
            </button>
            <button class="error outline"
                    hx-put="/api/offers/{{.ID}}/reject"
                    hx-confirm="Mark this offer as rejected?">
                Reject Offer
            </button>
        </div>
    </article>
    {{end}}
</article>

<!-- PDF Preview Template -->
{{define "pdf-preview"}}
<header>
    <h3>PDF Preview</h3>
</header>
<div class="preview-container">
    <iframe src="{{.}}" width="100%" height="600px"></iframe>
</div>
{{end}}
{{end}}